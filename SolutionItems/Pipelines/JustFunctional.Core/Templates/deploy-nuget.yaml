parameters:
  name: 'Release Job'
  poolName: ''
  builConfig: ''
  artifactName: ''
  feedId: ''
jobs:
  - deployment: 'release'
    displayName: '${{parameters.name}}'
    environment: 'production'
    pool:
      name: ${{parameters.poolName}} 
    strategy:
        runOnce: 
            deploy:
                steps:
                - task: DownloadPipelineArtifact@2
                  displayName: 'Download Artifact  - ${{parameters.artifactName}}'
                  inputs:
                    source: current
                    path: $(System.ArtifactsDirectory)/${{parameters.artifactName}}
                    artifact:  ${{parameters.artifactName}}

                - task: NuGetAuthenticate@0
                  displayName: 'Authenticate with the Feed'

                - task: NuGetCommand@2
                  displayName: 'NuGet push'
                  inputs:
                    packagesToPush: '$(System.ArtifactsDirectory)/${{parameters.artifactName}}/${{parameters.builConfig}}/*.nupkg'
                    command: push
                    feedsToUse: 'select'
                    publishVstsFeed: '${{parameters.feedId}}'
                    allowPackageConflicts: true